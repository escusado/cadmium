fs = require("fs");
microtime = require('microtime');
Thulium = require('thulium');

template = fs.readFileSync('etc/template.tm', {encoding : 'utf8'});

var times = {
  parse : [],
  render : [],
  init : []
}
var currentTime, min, max, avg, tm;

var benchmark = function (type, fn) {
  currentTime = microtime.now();
  fn();
  times[type].push(microtime.now() - currentTime)
}

var context = {i: 12, helpers: {
  embolden : function(fn){
    tm.renderer.print("<strong>");
    fn();
    return "</strong>";  
  },
  reverse : function(toCapture) {
    var buf = tm.renderer.capture(toCapture);

    return buf.split("").reverse().join("");
  }
}};

    tm = new Thulium({template : template});
    tm.parseSync();
    tm.renderSync(context);
